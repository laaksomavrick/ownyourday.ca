<%= turbo_frame_tag "task-type-turbo-frame" do %>
  <div class="space-y-4" data-controller="task-list">
    <% @task_list.tasks.each do |task| %>
      <div
        data-sortable-update-url="<%= task_position_path(task) %>"
        data-controller="task"
        data-action="click->task#toggleGoalCompletion"
        data-task-target="listItem"
        data-task-position="<%= task.position %>"
        data-task-type="<%= task.class.name %>"
        id="task-item-<%= task.id %>"
        class="flex items-center border rounded border-gray-300 p-4 cursor-pointer select-none <%= task.completed ? "opacity-50" : nil %>">
        <div class="max-w-sm mr-2 mr-4">
          <%= form_with model: task, url: task_path(task), method: "patch", scope: :task do |f| %>
            <%= f.check_box :completed, { checked: task.completed, data: { task_target: "checkbox", task_id: task.id } } %>
            <%= f.submit nil, { hidden: true, data: { task_target: "submit" } } %>
          <% end %>
        </div>
        <div class="w-full">
          <p class="text-3xl">
            <%= task.name %>
          </p>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
